

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Composite Hilbert Spaces, QuTiP Interface &mdash; scqubits Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Explorer" href="explorer.html" />
    <link rel="prev" title="Full Zero-Pi Qubit (incl. coupling to zeta mode)" href="../qubits/fullzeropi.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/scqubits-logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guide.html">Users Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../guide-overview.html">Guide Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-qubits.html">Qubits</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Composite Hilbert Spaces, QuTiP Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example:-two-transmons-coupled-to-a-harmonic-mode">Example: two transmons coupled to a harmonic mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Create-Hilbert-space-components">Create Hilbert space components</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set-up-the-interaction-between-subsystems">Set up the interaction between subsystems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Obtaining-the-eigenspectrum-via-QuTiP">Obtaining the eigenspectrum via QuTiP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Sweeping-over-an-external-parameter">Sweeping over an external parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="explorer.html">Explorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-plot-options.html">Plot Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-io.html">Writing Data and Figures to File</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel.html">Parallel Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-example-ipynb.html">Jupyter Notebook Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide-settings.html">Modifying Internal scqubits Settings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api-doc/apidoc.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html#contributors">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgments.html">Funding Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">scqubits</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../guide.html">Users Guide</a> &raquo;</li>
        
      <li>Composite Hilbert Spaces, QuTiP Interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;svg&#39;

<span class="kn">import</span> <span class="nn">scqubits</span> <span class="k">as</span> <span class="nn">qubit</span>
<span class="kn">import</span> <span class="nn">scqubits.utils.sweep_plotting</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="kn">from</span> <span class="nn">scqubits</span> <span class="kn">import</span> <span class="n">HilbertSpace</span><span class="p">,</span> <span class="n">InteractionTerm</span><span class="p">,</span> <span class="n">ParameterSweep</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
</pre></div>
</div>
</div>
<div class="section" id="Composite-Hilbert-Spaces,-QuTiP-Interface">
<h1>Composite Hilbert Spaces, QuTiP Interface<a class="headerlink" href="#Composite-Hilbert-Spaces,-QuTiP-Interface" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> class provides data structures and methods for handling composite Hilbert spaces which may consist of multiple qubits or qubits and oscillators coupled to each other. To harness the power of QuTiP, a toolbox for studying stationary and dynamical properties of closed and open quantum systems (and much more), <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> provides a convenient interface: it generates <code class="docutils literal notranslate"><span class="pre">qutip.qobj</span></code> objects which are then directly handled by QuTiP.</p>
<div class="section" id="Example:-two-transmons-coupled-to-a-harmonic-mode">
<h2>Example: two transmons coupled to a harmonic mode<a class="headerlink" href="#Example:-two-transmons-coupled-to-a-harmonic-mode" title="Permalink to this headline">¶</a></h2>
<p>Transmon qubits can be capacitively coupled to a common harmonic mode, realized by an LC oscillator or a transmission-line resonator. The Hamiltonian describing such a composite system is given by:</p>
<div class="math notranslate nohighlight">
\begin{equation}
H=H_\text{tmon,1} + H_\text{tmon,2} + \omega_r a^\dagger a + \sum_{j=1,2}g_j n_j(a+a^\dagger),
\end{equation}</div><p>where <span class="math notranslate nohighlight">\(j=1,2\)</span> enumerates the two transmon qubits, <span class="math notranslate nohighlight">\(\omega_r\)</span> is the (angular) frequency of the resonator. Furthermore, <span class="math notranslate nohighlight">\(n_j\)</span> is the charge number operator for qubit <span class="math notranslate nohighlight">\(j\)</span>, and <span class="math notranslate nohighlight">\(g_j\)</span> is the coupling strength between qubit <span class="math notranslate nohighlight">\(j\)</span> and the resonator.</p>
<div class="section" id="Create-Hilbert-space-components">
<h3>Create Hilbert space components<a class="headerlink" href="#Create-Hilbert-space-components" title="Permalink to this headline">¶</a></h3>
<p>The first step consists of creating the objects describing the individual building blocks of the full Hilbert space. Here, these will be the two transmons and one oscillator:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tmon1</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">Transmon</span><span class="p">(</span>
    <span class="n">EJ</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span>
    <span class="n">EC</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">ng</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">ncut</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">truncated_dim</span><span class="o">=</span><span class="mi">4</span>     <span class="c1"># after diagonalization, we will keep 3 levels</span>
<span class="p">)</span>

<span class="n">tmon2</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">Transmon</span><span class="p">(</span>
    <span class="n">EJ</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span>
    <span class="n">EC</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">ng</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">ncut</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">truncated_dim</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>

<span class="n">resonator</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">Oscillator</span><span class="p">(</span>
    <span class="n">E_osc</span><span class="o">=</span><span class="mf">4.5</span><span class="p">,</span>
    <span class="n">truncated_dim</span><span class="o">=</span><span class="mi">4</span>  <span class="c1"># up to 3 photons (0,1,2,3)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>The system objects are next grouped into a Python list, and in this form used for the initialization of a <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> object. Once created, a print call to this object outputs a summary of the composite Hilbert space.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hilbertspace</span> <span class="o">=</span> <span class="n">qubit</span><span class="o">.</span><span class="n">HilbertSpace</span><span class="p">([</span><span class="n">tmon1</span><span class="p">,</span> <span class="n">tmon2</span><span class="p">,</span> <span class="n">resonator</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hilbertspace</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
====== HilbertSpace object ======

TRANSMON
 ———— PARAMETERS ————
EJ      : 40.0
EC      : 0.2
ng      : 0.3
ncut    : 40
truncated_dim   : 4
Hilbert space dimension : 81

TRANSMON
 ———— PARAMETERS ————
EJ      : 15.0
EC      : 0.15
ng      : 0.0
ncut    : 30
truncated_dim   : 4
Hilbert space dimension : 61

OSCILLATOR
 ———— PARAMETERS ————
E_osc   : 4.5
truncated_dim   : 4
Hilbert space dimension : 4

</pre></div></div>
</div>
<p>One useful method of the <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> class is <code class="docutils literal notranslate"><span class="pre">.bare_hamiltonian()</span></code>. This yields the bare Hamiltonian of the non-interacting subsystems, expressed as a <code class="docutils literal notranslate"><span class="pre">qutip.Qobj</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bare_hamiltonian</span> <span class="o">=</span> <span class="n">hilbertspace</span><span class="o">.</span><span class="n">bare_hamiltonian</span><span class="p">()</span>
<span class="n">bare_hamiltonian</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
Quantum object: dims = [[4, 4, 4], [4, 4, 4]], shape = (64, 64), type = oper, isherm = True\begin{equation*}\left(\begin{array}{*{11}c}-48.968 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; -44.468 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; -39.968 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; -35.468 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; -44.881 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; -4.723 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; -14.477 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; -9.977 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; -5.477 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; -0.977\\\end{array}\right)\end{equation*}</div></div>
</div>
</div>
<div class="section" id="Set-up-the-interaction-between-subsystems">
<h3>Set up the interaction between subsystems<a class="headerlink" href="#Set-up-the-interaction-between-subsystems" title="Permalink to this headline">¶</a></h3>
<p>The pairwise interactions between subsystems are assumed to have the general form</p>
<p><span class="math notranslate nohighlight">\(V=\sum_{i\not= j} g_{ij} A_i B_j\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(g_{ij}\)</span> parametrizes the interaction strength between subsystems <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>. The operator content of the coupling is given by the two coupling operators <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(B_j\)</span>, which are operators in the two respective subsystems. This structure is captured by setting up an <code class="docutils literal notranslate"><span class="pre">InteractionTerm</span></code> object:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">g1</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># coupling resonator-CPB1 (without charge matrix elements)</span>
<span class="n">g2</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># coupling resonator-CPB2 (without charge matrix elements)</span>

<span class="n">interaction1</span> <span class="o">=</span> <span class="n">InteractionTerm</span><span class="p">(</span>
    <span class="n">hilbertspace</span> <span class="o">=</span> <span class="n">hilbertspace</span><span class="p">,</span>
    <span class="n">g_strength</span> <span class="o">=</span> <span class="n">g1</span><span class="p">,</span>
    <span class="n">op1</span> <span class="o">=</span> <span class="n">tmon1</span><span class="o">.</span><span class="n">n_operator</span><span class="p">(),</span>
    <span class="n">subsys1</span> <span class="o">=</span> <span class="n">tmon1</span><span class="p">,</span>
    <span class="n">op2</span> <span class="o">=</span> <span class="n">resonator</span><span class="o">.</span><span class="n">creation_operator</span><span class="p">()</span> <span class="o">+</span> <span class="n">resonator</span><span class="o">.</span><span class="n">annihilation_operator</span><span class="p">(),</span>
    <span class="n">subsys2</span> <span class="o">=</span><span class="n">resonator</span>
<span class="p">)</span>

<span class="n">interaction2</span> <span class="o">=</span> <span class="n">InteractionTerm</span><span class="p">(</span>
    <span class="n">hilbertspace</span> <span class="o">=</span> <span class="n">hilbertspace</span><span class="p">,</span>
    <span class="n">g_strength</span> <span class="o">=</span> <span class="n">g2</span><span class="p">,</span>
    <span class="n">op1</span> <span class="o">=</span> <span class="n">tmon2</span><span class="o">.</span><span class="n">n_operator</span><span class="p">(),</span>
    <span class="n">subsys1</span> <span class="o">=</span> <span class="n">tmon2</span><span class="p">,</span>
    <span class="n">op2</span> <span class="o">=</span> <span class="n">resonator</span><span class="o">.</span><span class="n">creation_operator</span><span class="p">()</span> <span class="o">+</span> <span class="n">resonator</span><span class="o">.</span><span class="n">annihilation_operator</span><span class="p">(),</span>
    <span class="n">subsys2</span> <span class="o">=</span> <span class="n">resonator</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">InteractionTerm</span></code> object is initialized by specifying 1. the Hilbert space object to which it will belong 2. the interaction strength coefficient <span class="math notranslate nohighlight">\(g_{ij}\)</span> 3. <code class="docutils literal notranslate"><span class="pre">op1</span></code>, <code class="docutils literal notranslate"><span class="pre">op2</span></code>: the subsystem operators <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(B_j\)</span> (these should be operators within the subsystems’ respective Hilbert spaces only) 4. <code class="docutils literal notranslate"><span class="pre">subsys1</span></code>: the subsystem objects to which <code class="docutils literal notranslate"><span class="pre">op1</span></code> and <code class="docutils literal notranslate"><span class="pre">op2</span></code> belong</p>
<p>Note: interaction Hamiltonians of the alternative form <span class="math notranslate nohighlight">\(V=g_{ij}A_i B_j^\dagger + g_{ij}^* A_i^\dagger B_J\)</span> (a typical form when performing rotating-wave approximation) can be specified by setting <code class="docutils literal notranslate"><span class="pre">op1</span></code> to <span class="math notranslate nohighlight">\(A_i\)</span> and <code class="docutils literal notranslate"><span class="pre">op2</span></code> to <span class="math notranslate nohighlight">\(B_j^\dagger\)</span>, and providing the additional keyword parameter <code class="docutils literal notranslate"><span class="pre">add_hc</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<p>Now, collect all interaction terms in a list, and insert into the HilbertSpace object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">interaction_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">interaction1</span><span class="p">,</span> <span class="n">interaction2</span><span class="p">]</span>
<span class="n">hilbertspace</span><span class="o">.</span><span class="n">interaction_list</span> <span class="o">=</span> <span class="n">interaction_list</span>
</pre></div>
</div>
</div>
<p>With the interactions specified, the full Hamiltonian of the coupled system can be obtained via the method <code class="docutils literal notranslate"><span class="pre">.hamiltonian()</span></code>. Again, this conveniently results in a <code class="docutils literal notranslate"><span class="pre">qubit.Qobj</span></code> operator:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dressed_hamiltonian</span> <span class="o">=</span> <span class="n">hilbertspace</span><span class="o">.</span><span class="n">hamiltonian</span><span class="p">()</span>
<span class="n">dressed_hamiltonian</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
Quantum object: dims = [[4, 4, 4], [4, 4, 4]], shape = (64, 64), type = oper, isherm = True\begin{equation*}\left(\begin{array}{*{11}c}-48.968 &amp; 0.030 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.030 &amp; -44.468 &amp; 0.042 &amp; 0.0 &amp; 0.261 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.042 &amp; -39.968 &amp; 0.052 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.052 &amp; -35.468 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.261 &amp; 0.0 &amp; 0.0 &amp; -44.881 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0\\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; -4.723 &amp; 0.0 &amp; 0.0 &amp; -0.749 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; -14.477 &amp; 0.030 &amp; 0.0 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.030 &amp; -9.977 &amp; 0.042 &amp; 0.0\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; -0.749 &amp; 0.0 &amp; 0.042 &amp; -5.477 &amp; 0.052\\0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; \cdots &amp; 0.0 &amp; 0.0 &amp; 0.0 &amp; 0.052 &amp; -0.977\\\end{array}\right)\end{equation*}</div></div>
</div>
</div>
<div class="section" id="Obtaining-the-eigenspectrum-via-QuTiP">
<h3>Obtaining the eigenspectrum via QuTiP<a class="headerlink" href="#Obtaining-the-eigenspectrum-via-QuTiP" title="Permalink to this headline">¶</a></h3>
<p>Since the Hamiltonian obtained this way is a proper <code class="docutils literal notranslate"><span class="pre">qutip.qobj</span></code>, all QuTiP routines are now available. For instance, here is how to obtain eigenenergies and eigenstates:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">hilbertspace</span><span class="o">.</span><span class="n">eigensys</span><span class="p">(</span><span class="n">evals_count</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">evals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-48.97770317 -45.02707241 -44.36656205 -41.18438832]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Sweeping-over-an-external-parameter">
<h2>Sweeping over an external parameter<a class="headerlink" href="#Sweeping-over-an-external-parameter" title="Permalink to this headline">¶</a></h2>
<p>scqubits provides the class <code class="docutils literal notranslate"><span class="pre">ParameterSweep</span></code> to facilitate computation of spectra as function of an external parameter. For efficiency in creating different plots, the computed bare and dressed spectral data are stored internally. A sweep object is initialized as follows.</p>
<p>Suppose both <code class="docutils literal notranslate"><span class="pre">tmon1</span></code> and <code class="docutils literal notranslate"><span class="pre">tmon2</span></code> subsystems are flux-tunable split-junction transmons with different loop areas. We consider sweeping a global external flux through the loops. To create the necessary <code class="docutils literal notranslate"><span class="pre">ParameterSweep</span></code> object, we specify: 1. <code class="docutils literal notranslate"><span class="pre">param_name</span></code>: the name of the sweep parameter (below expressed as the flux in units of the flux quantum) 2. <code class="docutils literal notranslate"><span class="pre">param_vals</span></code>: an array with the flux values used in the sweep 3. <code class="docutils literal notranslate"><span class="pre">subsys_update_list</span></code>: a list containing all Hilbert space subsystems that
change as the flux is varied 4. <code class="docutils literal notranslate"><span class="pre">update_hilbertspace(param_val)</span></code>: a function that shows how a change in the sweep parameter affects the Hilbert space; here only the <code class="docutils literal notranslate"><span class="pre">.flux</span></code> attributed of the fluxonium qubit needs to be changed</p>
<p>These ingredients all make it into the initialization of the <code class="docutils literal notranslate"><span class="pre">ParameterSweep</span></code> object. Once initialized, spectral data is generated and stored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">param_name</span> <span class="o">=</span> <span class="s1">&#39;flux&#39;</span>                          <span class="c1"># name of varying external parameter</span>
<span class="n">param_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>     <span class="c1"># parameter values</span>

<span class="n">subsys_update_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">tmon1</span><span class="p">,</span> <span class="n">tmon2</span><span class="p">]</span>          <span class="c1"># list of HilbertSpace subsystems which are affected by parameter changes</span>

<span class="k">def</span> <span class="nf">update_hilbertspace</span><span class="p">(</span><span class="n">param_val</span><span class="p">):</span>          <span class="c1"># function that shows how Hilbert space components are updated</span>
    <span class="n">tmon1</span><span class="o">.</span><span class="n">EJ</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">param_val</span><span class="p">))</span>
    <span class="n">tmon2</span><span class="o">.</span><span class="n">EJ</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">param_val</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">))</span>


<span class="n">sweep</span> <span class="o">=</span> <span class="n">ParameterSweep</span><span class="p">(</span>
    <span class="n">param_name</span><span class="o">=</span><span class="n">param_name</span><span class="p">,</span>
    <span class="n">param_vals</span><span class="o">=</span><span class="n">param_vals</span><span class="p">,</span>
    <span class="n">evals_count</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">hilbertspace</span><span class="o">=</span><span class="n">hilbertspace</span><span class="p">,</span>
    <span class="n">subsys_update_list</span><span class="o">=</span><span class="n">subsys_update_list</span><span class="p">,</span>
    <span class="n">update_hilbertspace</span><span class="o">=</span><span class="n">update_hilbertspace</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Once the data has been generated, the spectrum can be plotted as a function of the parameter value:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">splot</span><span class="o">.</span><span class="n">dressed_spectrum</span><span class="p">(</span><span class="n">sweep</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/guide_ipynb_hilbertspace_21_0.svg" src="../../_images/guide_ipynb_hilbertspace_21_0.svg" /></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="explorer.html" class="btn btn-neutral float-right" title="Explorer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../qubits/fullzeropi.html" class="btn btn-neutral float-left" title="Full Zero-Pi Qubit (incl. coupling to zeta mode)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jens Koch, Peter Groszkowski

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>